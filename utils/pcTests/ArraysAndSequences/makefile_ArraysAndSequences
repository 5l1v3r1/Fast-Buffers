BASEDIR=.
OUTDIR= $(BASEDIR)/output
CC= gcc
CPP= g++
LN= g++
AR=ar
CP=cp

-include $(EPROSIMADIR)/building/makefiles/eProsima.mk

ARRAYSANDSEQUENCES_CFLAGS= $(CFLAGS) -std=c++0x

ARRAYSANDSEQUENCES_INCLUDES= -I. -I$(FAST_BUFFERS)/include

ARRAYSANDSEQUENCES_LIBS= -Wl,-Bstatic -L$(BASEDIR)/lib/$(EPROSIMA_TARGET) -lArraysAndSequences -L$(FAST_BUFFERS)/lib/$(EPROSIMA_TARGET) -lcdr \
						 -Wl,-Bdynamic

ARRAYSANDSEQUENCES_DIRECTORIES= $(BASEDIR)/output.dir $(BASEDIR)/output/$(EPROSIMA_TARGET).dir $(BASEDIR)/bin.dir $(BASEDIR)/bin/$(EPROSIMA_TARGET).dir

all: $(ARRAYSANDSEQUENCES_DIRECTORIES) ArraysAndSequencesTest

ARRAYSANDSEQUENCES_TARGET= $(BASEDIR)/bin/$(EPROSIMA_TARGET)/ArraysAndSequencesTest

ARRAYSANDSEQUENCES_SRC_CPPFILES= ArraysAndSequencesTest.cpp

ARRAYSANDSEQUENCES_OBJS = $(ARRAYSANDSEQUENCES_SRC_CPPFILES:%.cpp=output/$(EPROSIMA_TARGET)/%.o)

OBJS+= $(ARRAYSANDSEQUENCES_OBJS)

ArraysAndSequencesTest: $(ARRAYSANDSEQUENCES_TARGET)

$(ARRAYSANDSEQUENCES_TARGET): $(ARRAYSANDSEQUENCES_OBJS)
	$(LN) $(LDFLAGS) -o $(ARRAYSANDSEQUENCES_TARGET) $(ARRAYSANDSEQUENCES_OBJS) $(ARRAYSANDSEQUENCES_LIBS)

output/$(EPROSIMA_TARGET)/%.o:%.cpp
	$(CPP) $(ARRAYSANDSEQUENCES_CFLAGS) $(ARRAYSANDSEQUENCES_INCLUDES) $< -o $@

.PHONY: ArraysAndSequencesTest

clean:
	@rm -f $(OBJS)

%.dir : 
	@echo "Checking directory $*"
	@if [ ! -d $* ]; then \
		echo "Making directory $*"; \
		mkdir -p $* ; \
	fi;
