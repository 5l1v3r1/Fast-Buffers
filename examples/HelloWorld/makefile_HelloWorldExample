CC=gcc
CPP=g++
LN=g++
AR=ar
CP=cp

CPPFLAGS= -c -Wall -DEPROSIMA_LINUX -m64 -fpic -std=c++11
LDFLAGS=-m64

INCLUDES = -I. -I$(FAST_BUFFERS)/include

LIBS =  -L$(FAST_BUFFERS)/lib/TARGET_TO_SUBSTITUTE -L./lib/TARGET_TO_SUBSTITUTE \
	-lHelloWorldz -lcdrz 

CPPSOURCES = HelloWorldExample.cpp

DIRECTORIES   = output.dir output/TARGET_TO_SUBSTITUTE.dir bin.dir bin/TARGET_TO_SUBSTITUTE.dir
OBJS    = $(CPPSOURCES:%.cpp=output/TARGET_TO_SUBSTITUTE/%.o)
EXEC    = bin/TARGET_TO_SUBSTITUTE/HelloWorldExample

example: $(DIRECTORIES) $(OBJS) $(EXEC)

$(EXEC) : 
	$(LN) $(LDFLAGS) -o $(@:%.out=%) $(OBJS) $(LIBS)

output/TARGET_TO_SUBSTITUTE/%.o : %.cpp
	$(CPP) $(CPPFLAGS)  -o $@ $(INCLUDES) -c $<

# Here is how we create those subdirectories automatically.
%.dir : 
	@echo "Checking directory $*"
	@if [ ! -d $* ]; then \
		echo "Making directory $*"; \
		mkdir -p $* ; \
	fi;

